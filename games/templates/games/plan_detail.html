{% extends 'games/base.html' %}
{% load static %}

{% block title %}{{ plan.name }} - Retro Games Cloud{% endblock %}

{% block content %}
<!-- Breadcrumb -->
<nav aria-label="breadcrumb" class="modern-breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'home' %}">Início</a></li>
        <li class="breadcrumb-item active">{{ plan.name }}</li>
    </ol>
</nav>

<div class="row">
    <!-- Informações do Plano -->
    <div class="col-lg-8">
        <div class="modern-card">
            <div class="text-center mb-4">
                <i class="fas fa-crown fa-3x text-gradient mb-3"></i>
                <h1 class="retro-title">{{ plan.name }}</h1>
                <p class="retro-subtitle">{{ plan.description }}</p>
            </div>
            
            <div class="text-center mb-4">
                <span class="modern-badge modern-badge-primary fs-3">
                    <i class="fas fa-dollar-sign me-1"></i>R$ {{ plan.price }}/mês
                </span>
            </div>
            
            <!-- Ações -->
            <div class="d-flex gap-3 flex-wrap justify-content-center">
                {% if user.is_authenticated %}
                    {% if user_has_subscription %}
                        <div class="modern-alert modern-alert-success">
                            <i class="fas fa-check-circle me-2"></i>
                            Você já possui uma assinatura ativa para este plano!
                        </div>
                        <a href="{% url 'library' %}" class="modern-btn modern-btn-primary">
                            <i class="fas fa-book me-1"></i>Ir para Biblioteca
                        </a>
                    {% else %}
                        <a href="{% url 'checkout_plan' plan.id %}" class="modern-btn modern-btn-primary">
                            <i class="fas fa-crown me-1"></i>Assinar Agora
                        </a>
                    {% endif %}
                {% else %}
                    <div class="modern-alert modern-alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        Faça login para assinar este plano
                    </div>
                    <a href="{% url 'login' %}" class="modern-btn modern-btn-primary">
                        <i class="fas fa-sign-in-alt me-1"></i>Fazer Login
                    </a>
                {% endif %}
                
                <a href="{% url 'home' %}" class="modern-btn modern-btn-secondary">
                    <i class="fas fa-arrow-left me-1"></i>Voltar
                </a>
            </div>
        </div>
    </div>
    
    <!-- Estatísticas do Plano -->
    <div class="col-lg-4">
        <div class="modern-card">
            <h3 class="retro-heading mb-3">
                <i class="fas fa-chart-bar me-2"></i>Estatísticas
            </h3>
            <div class="text-center mb-3">
                <i class="fas fa-gamepad fa-2x text-gradient mb-2"></i>
                <h4 class="retro-heading">{{ plan.games.count }}</h4>
                <p class="retro-text">Jogos Incluídos</p>
            </div>
            <div class="text-center mb-3">
                <i class="fas fa-dollar-sign fa-2x text-gradient mb-2"></i>
                <h4 class="retro-heading">R$ {{ plan.price }}</h4>
                <p class="retro-text">Por Mês</p>
            </div>
            <div class="text-center">
                <i class="fas fa-calendar fa-2x text-gradient mb-2"></i>
                <h4 class="retro-heading">30</h4>
                <p class="retro-text">Dias de Acesso</p>
            </div>
        </div>
    </div>
</div>

<!-- Jogos Incluídos -->
<div class="row mt-4">
    <div class="col-12">
        <div class="modern-card">
            <h3 class="retro-heading mb-4">
                <i class="fas fa-gamepad me-2"></i>Jogos Incluídos no Plano
            </h3>
            
            {% if plan.games.all %}
            <div class="row g-4">
                {% for game in plan.games.all %}
                <div class="col-lg-3 col-md-4 col-sm-6">
                    <div class="game-card-modern h-100">
                        <div class="game-image-modern" style="background-image: url('{{ game.cover_image }}');">
                            <div class="position-absolute top-0 end-0 p-2">
                                <span class="modern-badge modern-badge-success">
                                    <i class="fas fa-check me-1"></i>Incluído
                                </span>
                            </div>
                        </div>
                        <div class="game-title-modern">
                            <h6 class="game-title-modern">{{ game.title }}</h6>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="game-console-modern">{{ game.console }}</span>
                                <a href="{% url 'game_detail' game.id %}" class="modern-btn modern-btn-primary btn-sm">
                                    <i class="fas fa-eye me-1"></i>Ver
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="text-center">
                <i class="fas fa-gamepad fa-3x text-muted mb-3"></i>
                <h4 class="retro-heading">Nenhum jogo incluído</h4>
                <p class="retro-text">Este plano ainda não possui jogos.</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Informações Adicionais -->
<div class="row mt-4">
    <div class="col-12">
        <div class="modern-card">
            <h3 class="retro-heading mb-3">
                <i class="fas fa-info-circle me-2"></i>Informações do Plano
            </h3>
            <div class="row">
                <div class="col-md-3">
                    <div class="text-center">
                        <i class="fas fa-crown fa-2x text-gradient mb-2"></i>
                        <h5 class="retro-heading">Nome</h5>
                        <p class="retro-text">{{ plan.name }}</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="text-center">
                        <i class="fas fa-dollar-sign fa-2x text-gradient mb-2"></i>
                        <h5 class="retro-heading">Preço</h5>
                        <p class="retro-text">R$ {{ plan.price }}/mês</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="text-center">
                        <i class="fas fa-gamepad fa-2x text-gradient mb-2"></i>
                        <h5 class="retro-heading">Jogos</h5>
                        <p class="retro-text">{{ plan.games.count }} incluídos</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="text-center">
                        <i class="fas fa-calendar fa-2x text-gradient mb-2"></i>
                        <h5 class="retro-heading">Período</h5>
                        <p class="retro-text">30 dias</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Efeito de hover nos cards de jogos
    const gameCards = document.querySelectorAll('.game-card-modern');
    gameCards.forEach(card => {
        card.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-8px)';
        });
        card.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0)';
        });
    });
    
    // Efeito de hover nas imagens dos jogos
    const gameImages = document.querySelectorAll('.game-image-modern');
    gameImages.forEach(img => {
        img.addEventListener('mouseenter', function() {
            this.style.transform = 'scale(1.05)';
        });
        img.addEventListener('mouseleave', function() {
            this.style.transform = 'scale(1)';
        });
    });
    
    // Efeito de hover nos badges
    const badges = document.querySelectorAll('.modern-badge');
    badges.forEach(badge => {
        badge.addEventListener('mouseenter', function() {
            this.style.transform = 'scale(1.1)';
        });
        badge.addEventListener('mouseleave', function() {
            this.style.transform = 'scale(1)';
        });
    });
    
    // Animação de entrada
    const cards = document.querySelectorAll('.modern-card');
    cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(30px)';
        setTimeout(() => {
            card.style.transition = 'all 0.6s ease';
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, index * 200);
    });
    
    // Efeito de digitação no título
    const title = document.querySelector('.retro-title');
    if (title) {
        const text = title.textContent;
        title.textContent = '';
        let i = 0;
        const typeWriter = () => {
            if (i < text.length) {
                title.textContent += text.charAt(i);
                i++;
                setTimeout(typeWriter, 100);
            }
        };
        setTimeout(typeWriter, 500);
    }
});
</script>
{% endblock %}